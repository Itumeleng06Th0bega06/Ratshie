{%extends 'base.html' %}
{% load static %}
{% block content %}
<div id="banner-area" class="banner-area" style="background-image:url({% static 'theme/images/banner/banner1.jpg' %})">
    <div class="banner-text">
      <div class="container">
          <div class="row">
            <div class="col-lg-12">
                <div class="banner-heading">
                  <h1 class="banner-title">Billing Info</h1>
                  
                </div>
            </div><!-- Col end -->
          </div><!-- Row end -->
      </div><!-- Container end -->
    </div><!-- Banner text end -->
  </div><!-- Banner area end --> 

  <div class="checkout-container">
    <div class="row">
      <!-- Left Column - Order Summary -->
      
      
      <!-- Right Column - Checkout Form -->
      <div class="col-md-6 checkout-form">
        
    
        <strong>Shipping Information</strong>
        Name: {{ shipping_info.shipping_full_name }}</br>
        Email: {{ shipping_info.shipping_email }}</br>
        Address1: {{ shipping_info.shipping_address1 }}</br>
        Address2: {{ shipping_info.shipping_address }}</br>
        City: {{ shipping_info.shipping_city }}</br>
        State: {{ shipping_info.shipping_state }}</br>
        ZipCode: {{ shipping_info.shipping_zipcode }}</br>
        Country: {{ shipping_info.shipping_country }}</br>
                          
        <a href = "{% url 'checkout' %}" class = "btn btn-block mt-1 py-1 btn-primary">Update Shipping</a>
        
      </div>

      </br></br>
        {{ paypal_form.render }}
      </br></br></br></br>

      <div class="col-md-6 checkout-form">
        <strong>Billing Information</strong>
        
        <form method="POST" action="{% url 'process_order' %}">
          {% csrf_token %}
          {{ billing_form.as_p }}
          <button type="submit" class="btn btn-primary btn-block mt-4 py-3" class="submit-btn">Pay R{{ totals }}</button>
        </form>

        
         <!-- PAYPAL BUTTONS HERE  -->

                    <div id="paypal-button-container"></div>

                    <!-- Include the PayPal JavaScript SDK -->
                    <script
                        src="https://www.paypal.com/sdk/js?client-id=AU4tSiGfa7uoXlk3dHrWzzFE0GfBbLe92CkhfiStkyGlojoysfh9NqQh7gzrgZ9jF_p4pp0Lyy3G_mSy&currency=USD">
                    </script>

                    <script>
                        // Render the PayPal button into #paypal-button-container
                        paypal.Buttons({

                            // Set up the transaction
                            createOrder: function (data, actions) {
                                return actions.order.create({
                                    purchase_units: [{
                                        amount: {
                                            value: {{ totals | floatformat:2 }}
                                        }
                                    }]
                                });
                            },

                            // Finalize the transaction
                            onApprove: function (data, actions) {
                                return actions.order.capture().then(function (details) {
                                    // Show a success message to the buyer
                                    alert('Transaction completed by ' + details.payer.name
                                        .given_name + '!');
                                });
                            }


                        }).render('#paypal-button-container');
                    </script>

                </div>
      </div>
    </div>
  </div>
{% endblock %}